{% extends 'tournament/base.html' %}
{% load static%}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'styles/ranking.css' %}">
{% endblock %}

{% block content %}
<div class="content-grid">
    <div>
        <h2>Classifiche</h2>
        {% if not drawing_done %}
        <div class="alert">
            <p>Il sorteggio dei gruppi non è ancora stato fatto. Ritorna più tardi.</p>
        </div>
        {% else %}
        {% for group_name, teams in sorted_groups.items %}
        <h3>{{ group_name }}</h3>
        <table>
            <tr>
                <th class="team-name">Squadra</th>
                <th>Punti</th>
                <th>Goal Fatti</th>
                <th>Goal Subiti</th>
                <th>Differenza Reti</th>
            </tr>
            {% for team in teams %}
            <tr class="{% if team.team_name in context.qualified_team_names %}highlight{% endif %}">
                <td class="team-name">{{ team.team_name }}</td>
                <td>{{ team.points }}</td>
                <td>{{ team.goals_scored }}</td>
                <td>{{ team.goals_conceded }}</td>
                <td>{{ team.goal_difference }}</td>
            </tr>
            {% endfor %}
        </table>
        {% endfor %}
        {% endif %}

        <!-- Goal Scorers Table -->
        <h2>Classifica Marcatori</h2>
        <table>
            <tr>
                <th>Posizione</th>
                <th>Giocatore</th>
                <th>Squadra</th>
                <th>Goal</th>
            </tr>
            {% for scorer in top_scorers %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ scorer.name }}</td>
                <td>{{ scorer.team.name }}</td>
                <td>{{ scorer.total_goals }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>
    <div class="knockout-schedule">
        <h2>Fase ad Eliminazione</h2>
        <div>
            <h3>Quarti di Finale</h3>
            {% for match in context.quarterfinals_matches %}
            <div class="matchup">
                <span class="{% if match.score_home_team > match.score_away_team %}next-turn{% endif %}">
                    {{ match.home_team.name }}
                </span>
                <span>vs</span>
                <span class="{% if match.score_home_team < match.score_away_team %}next-turn{% endif %}">
                    {{ match.away_team.name }}
                </span>
                <span>{{ match.score_home_team }} - {{ match.score_away_team }}</span>
            </div>
            {% endfor %}
            <h3>Semifinali</h3>
            {% for match in context.semifinals_matches %}
            <div class="matchup">
                <span class="{% if match.score_home_team > match.score_away_team %}next-turn{% endif %}">
                    {{ match.home_team.name }}
                </span>
                <span>vs</span>
                <span class="{% if match.score_home_team < match.score_away_team %}next-turn{% endif %}">
                    {{ match.away_team.name }}
                </span>
                <span>{{ match.score_home_team }} - {{ match.score_away_team }}</span>
            </div>
            {% endfor %}
            <h3>Finali</h3>
            {% for match in context.finals_matches %}
            <div class="matchup">
                <span class="{% if match.score_home_team > match.score_away_team %}next-turn{% endif %}">
                    {{ match.home_team.name }}
                </span>
                <span>vs</span>
                <span class="{% if match.score_home_team < match.score_away_team %}next-turn{% endif %}">
                    {{ match.away_team.name }}
                </span>
                <span>{{ match.score_home_team }} - {{ match.score_away_team }}</span>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}